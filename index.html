<!DOCTYPE html>
<html>
  <style>
    body 
    {
      margin: 0px;
      padding: 0px;
      background: url("background.jpg") no-repeat;
      background-size: cover;
      font-family: 'Ubuntu', sans-serif;
      font-size: 14px; 
    }
  </style>   
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width", initial-scale=1.0>
    <meta http-equiv="X-UA-Compatible" content="ie-edge">
    <link rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" rel="stylesheet">
    <title>HAR WEB Project 2021</title>
  </head>

  <body>
    <div>
      <h1> Welcome!</h1> <br>

      <h2>Log in</h2>
      <div>
        <input type="username" placeholder="Username" name="username" id = "username"><br>
        <input type="password" placeholder="Password" name="password" id = "password"><br>
        <div id = "log_message"></div>
        
        <input type="submit" value="Login"  name="log-btn" id="log-btn">
        <div id = "log_error"></div>
      </div>

      <h2>Register</h2>
      <div>
        <input type="username" placeholder="Username"  name="username" id = "rusername"><br>
        <input type="email" placeholder="Email" name="email" id = "email"><br>
        <input type="password" placeholder="Password" name="password" id = "rpassword"><br>        
        <input type="password" placeholder="Confirm Password" name="cpassword" id = "cpassword"><br>
        <div id = "reg_message"></div>
        

        <input type="submit" value="Register" name="reg-btn" id = "reg-btn">
        <div id = "reg_error"></div>
      </div>
      
    </div>
    <!-- jQuery--> 
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

		<script>
      //LOG IN
			$(document).ready(function()
			{
				$("#log-btn").click(function()
				{
          var username = document.getElementById('username').value;
          var password = document.getElementById('password').value;

          if (username == "" || password == "")
          {
            document.getElementById('log_message').innerHTML = "Please fill in the blanks.";
          }
          else
					{
						$.ajax({
							type: "POST",
							url: "login.php",
							data: 
								{ 
									username: username,
									password: password
								},
							
							success: function (response) 
							{
								
								if (response == 1 )
								{
									window.location = "user/user.php";
                }
                else if ( response == -1)
                {
                  window.location = "admin/admin.php";
                }
								else
								{	
                  document.getElementById('log_error').innerHTML = "Invalid username and password!";
								}
							}
						});
					}
				});
			});
    </script>
    <script>
      //SIGN UP
      $(document).ready(function()
			{
				$("#reg-btn").click(function()
				{
          
          var username = document.getElementById('rusername').value;
          var email = document.getElementById('email').value;
          var password = document.getElementById('rpassword').value;
          var cpassword = document.getElementById('cpassword').value;
          
          if( username == "" || email == "" || password == "" || cpassword == "")
          {
            document.getElementById('reg_message').innerHTML = "Please fill in the blanks.";
          }
          else if ( !password.match(cpassword) )
          {
            document.getElementById('reg_message').innerHTML = "Passwords do not match.";
          }
          else
          {
        
            $.ajax({
							type: "POST",
							url: "signup.php",
							data: 
								{ 
									username: username,
                  email: email,
                  password: password,
                  cpassword: cpassword
								},
							
							success: function (response) 
							{
								
								if (response == 1 )
								{
									window.location = "user/user.php";
								}
                else if (response == 0 )
                {
                  document.getElementById('reg_error').innerHTML = "There was an error. Please try again.";
                }
                else if (response == -1 )
                {
                  document.getElementById('reg_message').innerHTML = "Password should be at least 8 characters, contain an uppercase, a number and a special character.";
                }
                else if (response == -2 )
                {
                  document.getElementById('reg_message').innerHTML = "Username already taken.";
                }
                else console.log(response);
							}
						});
          }
        });
      });
    </script>
  </body>
</html>